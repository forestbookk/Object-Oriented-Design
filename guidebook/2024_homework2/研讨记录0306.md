# 研讨记录

​                                                                                                                                                           研讨日期：2024/3/6 

## 面向hw2现有架构的问题及其调整

问题：

* `ArrayList/HashMap` 存储`<指数, 系数>` `->` 底数混乱，难以仅用指数表示
* 解析和化简一体，Expr直接转换为`<指数,系数>`的集合 `->` 扩展性低

调整：

* 解析和化简分开

  * 解析-预处理

    * 消除连续的`+-`号
    * 正则展开幂

  * 化简

    * 指数大多时候不放进括号，性能较优。

    * 表达式化简使用`hashmap`实现，重写`equal`和`hashcode`

    * 化简的基础单元

      * 采用`HashMap<HashMap<String, BigInteger>, BigInteger>`记录`HashMap<<HashMap<base,index>, BigInteger>`

      * 构造mono类：

        * x的指数

        * `hashmap<exponent,factor>`

* 系数和指数的处理

  * 幂处理

    * 预处理正则展开

      在解析的时候，指数转换为连乘处理，添加因子。

    * 专门构造Pow类

      在toPoly方法运用快速幂展开。

  * 储存

    * 指数采用`BigInteger`
      * `HashMap`
      * `TreeMap`

## 程序的设计与实现

与会者基本采用了与演讲者一致的架构。故不作过多研讨。

## 数据生成策略

* 架构

  自下而上，类表达式文法构造。

* 如何兼顾控制生成数据的复杂度和覆盖的全面程度

  限制生成表达式的长度，并构造合理的常量池，且以轮盘赌的形式，将前导零、连续正负号等情况纳入表达式的构造。